<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GATE DA Progress Tracker with Firebase</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        /* Green bar at top and bottom */
        .top-bar, .bottom-bar {
            background-color: #4CAF50;
            height: 10px;
            width: 100%;
        }

        h1, h2 {
            color: #4CAF50;
            text-align: center;
        }

        .logo {
            display: block;
            margin: 20px auto;
            max-width: 100px;
        }

        .topic {
            background-color: #fff;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .topic-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        table {
            width: 100%;
            margin-bottom: 10px;
            border-collapse: collapse;
        }

        th, td {
            text-align: center;
            padding: 8px;
        }

        td:first-child {
            text-align: left;
        }

        /* Style the checkboxes */
        input[type="checkbox"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #4CAF50;
            border-radius: 5px;
            outline: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        input[type="checkbox"]:checked {
            background-color: #4CAF50;
        }

        /* Progress bar styles - fixed size */
        .progress-bar {
            width: 80%; /* Fixed width for uniformity */
            height: 20px;
            background-color: #f3f3f3;
            border-radius: 10px;
            margin: 10px auto; /* Centered horizontally */
            overflow: hidden;
        }

        .progress-bar div {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.3s;
        }

        /* Footer style */
        .footer {
            text-align: center;
            padding: 20px;
            font-size: 14px;
            color: #333;
        }

        .footer a {
            color: #4CAF50;
            text-decoration: none;
        }

    </style>
</head>
<body>

    <!-- Green bar at the top -->
    <div class="top-bar"></div>

    <h1>GATE DA 2025 Progress Tracker</h1>

      <!-- Google Sign-In/Sign-Out buttons and User Info -->
    <div style="text-align: center; margin-top: 20px;">
        <div id="user-info" style="font-size: 18px;">Please sign in</div>
        <button id="sign-in-button" onclick="googleSignIn()" style="margin: 10px; padding: 10px 20px; font-size: 16px;">Sign in with Google</button>
        <button id="sign-out-button" onclick="googleSignOut()" style="display: none; margin: 10px; padding: 10px 20px; font-size: 16px;">Sign Out</button>
    </div>

    <!-- Programming, Data Structures and Algorithms -->
    <div class="topic" data-topic="PDSA">
        <div class="topic-header">
            <h2>PDSA</h2>
        </div>
        <div class="progress-bar">
            <div></div>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Topic</th>
                    <th>Theory</th>
                    <th>Practice</th>
                    <th>1st Revision</th>
                    <th>2nd Revision</th>
                    <th>PYQ</th>
                    <th>Practice Test</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Programming in python</td>
                    <td><input type="checkbox" class="task" id="programming-1-theory"></td>
                    <td><input type="checkbox" class="task" id="programming-1-practice"></td>
                    <td><input type="checkbox" class="task" id="programming-1-rev1"></td>
                    <td><input type="checkbox" class="task" id="programming-1-rev2"></td>
                    <td><input type="checkbox" class="task" id="programming-1-pyq"></td>
                    <td><input type="checkbox" class="task" id="programming-1-test"></td>
                </tr>
                <tr>
                    <td>Stacks, Queue, Linked Lists, Hash Tables</td>
                    <td><input type="checkbox" class="task" id="programming-2-theory"></td>
                    <td><input type="checkbox" class="task" id="programming-2-practice"></td>
                    <td><input type="checkbox" class="task" id="programming-2-rev1"></td>
                    <td><input type="checkbox" class="task" id="programming-2-rev2"></td>
                    <td><input type="checkbox" class="task" id="programming-2-pyq"></td>
                    <td><input type="checkbox" class="task" id="programming-2-test"></td>
                </tr>
                <tr>
                    <td>Linear Search, Binary Search</td>
                    <td><input type="checkbox" class="task" id="programming-3-theory"></td>
                    <td><input type="checkbox" class="task" id="programming-3-practice"></td>
                    <td><input type="checkbox" class="task" id="programming-3-rev1"></td>
                    <td><input type="checkbox" class="task" id="programming-3-rev2"></td>
                    <td><input type="checkbox" class="task" id="programming-3-pyq"></td>
                    <td><input type="checkbox" class="task" id="programming-3-test"></td>
                </tr>
                <tr>
                    <td>Selection sort, Bubble sort, Insertion sort</td>
                    <td><input type="checkbox" class="task" id="programming-4-theory"></td>
                    <td><input type="checkbox" class="task" id="programming-4-practice"></td>
                    <td><input type="checkbox" class="task" id="programming-4-rev1"></td>
                    <td><input type="checkbox" class="task" id="programming-4-rev2"></td>
                    <td><input type="checkbox" class="task" id="programming-4-pyq"></td>
                    <td><input type="checkbox" class="task" id="programming-4-test"></td>
                </tr>
                <tr>
                    <td>Divide and Conquer: Merge sort, Quick sort</td>
                    <td><input type="checkbox" class="task" id="programming-5-theory"></td>
                    <td><input type="checkbox" class="task" id="programming-5-practice"></td>
                    <td><input type="checkbox" class="task" id="programming-5-rev1"></td>
                    <td><input type="checkbox" class="task" id="programming-5-rev2"></td>
                    <td><input type="checkbox" class="task" id="programming-5-pyq"></td>
                    <td><input type="checkbox" class="task" id="programming-5-test"></td>
                </tr>
                <tr>
                    <td>Graph theory</td>
                    <td><input type="checkbox" class="task" id="programming76theory"></td>
                    <td><input type="checkbox" class="task" id="programming-6-practice"></td>
                    <td><input type="checkbox" class="task" id="programming-6-rev1"></td>
                    <td><input type="checkbox" class="task" id="programming-6-rev2"></td>
                    <td><input type="checkbox" class="task" id="programming-6-pyq"></td>
                    <td><input type="checkbox" class="task" id="programming-6-test"></td>
                </tr>
                <tr>
                    <td>Graph Algorithms</td>
                    <td><input type="checkbox" class="task" id="programming-7-theory"></td>
                    <td><input type="checkbox" class="task" id="programming-7-practice"></td>
                    <td><input type="checkbox" class="task" id="programming-7-rev1"></td>
                    <td><input type="checkbox" class="task" id="programming-7-rev2"></td>
                    <td><input type="checkbox" class="task" id="programming-7-pyq"></td>
                    <td><input type="checkbox" class="task" id="programming-7-test"></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>Created by <a href="#">usnaveen</a></p>
    </div>

    <!-- Green bar at the bottom -->
    <div class="bottom-bar"></div>

    <!-- Firebase App (using ES Modules) -->
    <!-- Firebase App (using ES Modules) -->
    <script type="module">
        // Import the Firebase SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Google Sign-In function
        function googleSignIn() {
            signInWithPopup(auth, provider)
                .then((result) => {
                    const user = result.user;
                    console.log("User signed in: ", user.displayName);
                    loadCheckboxState(user.uid); // Load user-specific data
                })
                .catch((error) => {
                    console.error("Error during sign-in: ", error);
                });
        }

        // Sign Out function
        function googleSignOut() {
            signOut(auth).then(() => {
                console.log("User signed out.");
                location.reload(); // Reload the page after sign-out
            }).catch((error) => {
                console.error("Error during sign-out: ", error);
            });
        }

        // Listen to auth state changes
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in
                document.getElementById("user-info").innerText = `Hello, ${user.displayName}`;
                document.getElementById("sign-in-button").style.display = "none";
                document.getElementById("sign-out-button").style.display = "block";
                loadCheckboxState(user.uid); // Load the user's progress
            } else {
                // No user is signed in
                document.getElementById("user-info").innerText = "Please sign in";
                document.getElementById("sign-in-button").style.display = "block";
                document.getElementById("sign-out-button").style.display = "none";
            }
        });

        // Save checkbox state to Firestore
        async function saveCheckboxState(userId) {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const state = {};

            checkboxes.forEach((checkbox) => {
                state[checkbox.id] = checkbox.checked;
            });

            // Save the state to Firestore for the specific user
            try {
                await setDoc(doc(db, "progress", userId), state);
                console.log("Progress successfully saved to Firestore!");
            } catch (error) {
                console.error("Error saving progress: ", error);
            }
        }

        // Load checkbox state from Firestore
        async function loadCheckboxState(userId) {
            try {
                const docSnap = await getDoc(doc(db, "progress", userId));
                if (docSnap.exists()) {
                    const state = docSnap.data();
                    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                    checkboxes.forEach((checkbox) => {
                        checkbox.checked = state[checkbox.id] || false;
                    });

                    // Update progress for each topic after loading the state
                    document.querySelectorAll('.topic').forEach(topic => {
                        updateProgress(topic); // Recalculate progress for each topic
                    });
                } else {
                    console.log("No saved progress found.");
                }
            } catch (error) {
                console.error("Error loading progress: ", error);
            }
        }

        // Update progress bar based on checkboxes
        function updateProgress(topicElement) {
            const checkboxes = topicElement.querySelectorAll('input[type="checkbox"]');
            const progressBar = topicElement.querySelector('.progress-bar div');
            const total = checkboxes.length;
            const checked = Array.from(checkboxes).filter(checkbox => checkbox.checked).length;
            const progressPercentage = (checked / total) * 100;
            progressBar.style.width = progressPercentage + '%';
        }

        // Initialize progress and checkbox states on page load
        function initialize() {
            // Wait for auth state to change before loading progress
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    loadCheckboxState(user.uid); // Load user-specific progress data
                }
            });

            document.querySelectorAll('.topic').forEach(topic => {
                const checkboxes = topic.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        onAuthStateChanged(auth, (user) => {
                            if (user) {
                                saveCheckboxState(user.uid); // Save progress for the signed-in user
                                updateProgress(topic);
                            }
                        });
                    });
                });
            });
        }

        // Call initialize function when page loads
        window.onload = initialize;
    </script>

</body>
</html>
